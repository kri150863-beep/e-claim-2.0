<VirtualHost *:80>
    ServerName localhost
    DocumentRoot /var/www/html/public

    # ⚠️ CORRECTION: Passer le header Authorization sans mod_headers
    SetEnvIfNoCase Authorization "(.*)" HTTP_AUTHORIZATION=$1
    
    # Alternative avec RewriteRule
    RewriteEngine On
    RewriteCond %{HTTP:Authorization} ^(.*)
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%1]

    <Directory /var/www/html/public>
        AllowOverride All
        Order Allow,Deny
        Allow from All

        # Activer RewriteEngine
        RewriteEngine On
        
        # Passer Authorization header
        RewriteCond %{HTTP:Authorization} .
        RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

        # Règles Symfony
        FallbackResource /index.php
        
        # Ou avec mod_rewrite détaillé
        <IfModule mod_rewrite.c>
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteRule ^(.*)$ index.php [QSA,L]
        </IfModule>
    </Directory>

    ErrorLog /var/log/apache2/error.log
    CustomLog /var/log/apache2/access.log combined
</VirtualHost>